(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{419:function(t,s,a){"use strict";a.r(s);var e=a(1),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"title"}),a("p",[t._v("This post demonstrates how to create a simple class in VBA and to use it in the regular modules. Classes allows to package different properties and methods into a reusable “container”. It is extremely useful when the program constantly calling these methods/properties. This example will create a ADO database class which allows to connect to a MSSQL database. Consider this as an extension to the default ADODB class.")])]),t._v(" "),a("h2",{attrs:{id:"prerequisite"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prerequisite"}},[t._v("#")]),t._v(" Prerequisite")]),t._v(" "),a("p",[t._v("The following references must be checked in VBA so that the example can be ran without errors.")]),t._v(" "),a("ul",[a("li",[t._v("Microsoft ActiveX Data Objects Recordset 2.x Library")]),t._v(" "),a("li",[t._v("Microsoft ActiveX Data Objects 2.0 Library")]),t._v(" "),a("li",[t._v("Microsoft ADO Ext. 2.x for DLL and Security")])]),t._v(" "),a("h2",{attrs:{id:"declare-the-variables"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#declare-the-variables"}},[t._v("#")]),t._v(" Declare the variables")]),t._v(" "),a("p",[t._v("you gonna use inside the class module. Since we only want these variables to be recognized within this class. We will declare them to be Private.")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Option")]),t._v(" Explicit\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" conn "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ADODB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("connection\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" dbName "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n")])])]),a("h2",{attrs:{id:"get-let"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get-let"}},[t._v("#")]),t._v(" GET/LET")]),t._v(" "),a("p",[t._v("this is VBA’s way of reading (GET) and writing (LET) class properties.")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'write and read database name property")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" DataBaseName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\nDataBaseName "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" dbName\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" DataBaseName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndbName "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'read database connection string")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" ConnectionString"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nConnectionString "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" conn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ConnectionString\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n")])])]),a("h2",{attrs:{id:"constructors"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#constructors"}},[t._v("#")]),t._v(" Constructors")]),t._v(" "),a("p",[t._v("Every class will need (at least) one initialization procedure. This happens when you declare a class object in the regular module (a.k.a. main program).\nThe first way of initializing the class (using connection string directly):")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" Initialize"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByRef")]),t._v(" connectionStr "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'This sub will open a connection specified by a connection string")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'connectionStr: connection string")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' Open connection to database using connectionStr as connection string")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" conn "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("New")]),t._v(" ADODB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Connection\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" conn\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("On")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Error")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Resume")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ConnectionString "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" connectionStr\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ConnectionTimeout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' indefinite wait...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Open\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n")])])]),a("p",[t._v("The second way of initializing the class (using server name, catalog/database name, and credentials).")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" InitializeSQLDB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dataSource "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" catalog "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Optional")]),t._v(" userID "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'This sub initializes the connection to an SQL Server DB")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'dataSource: datasource i.e. server name")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'catalog: database name")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'userID: user ID")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" connStr "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" pwd "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Create connection string")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" Len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("userID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("''SQLNCLI11' windows credentials")]),t._v("\nconnStr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"Provider='SQLNCLI11';Data Source= \"")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" dataSource "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('";"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Initial Catalog="')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" catalog "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('";"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"Integrated Security= 'SSPI';\"")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Persist Security Info=False;"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"QuotedID=No"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'FrmPassword.Show")]),t._v("\npwd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" InputBox"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Password?"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'FrmPassword.Password 'Utils.GetInput(\"Enter password :\")")]),t._v("\nconnStr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"Provider='SQLNCLI11';Data Source= \"")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" dataSource "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('";"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Initial Catalog="')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" catalog "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('";"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"User ID="')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" userID "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('";"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Password="')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" pwd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('";"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Me")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DataBaseName "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" catalog "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' Set property")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Me")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Initialize connStr\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n")])])]),a("h2",{attrs:{id:"now-write-some-methods-functions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#now-write-some-methods-functions"}},[t._v("#")]),t._v(" Now, write some methods/functions")]),t._v(" "),a("p",[t._v("you want to do inside the class.\nThe very first thing I want this class to do is to execute an SQL query.")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" ExecuteSQLInDB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByRef")]),t._v(" sqlStr "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'This sub will Execute SQL in sqlStr")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" conn\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Execute sqlStr\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n")])])]),a("p",[t._v("Next, I want to have a way to clear out the records of an existing table.")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" ClearTable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tblName "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'This function will clear content of tblName in DB")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'tblName: name of table to cleared")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' adoConn: connection to database")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" sqlStr "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\nsqlStr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"DELETE FROM ["')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" tblName "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"]"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("On")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Error")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Resume")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\nApplication"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StatusBar "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Clearing Table ["')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" tblName "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"]"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Me")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ExecuteSQLInDB sqlStr\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" Err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Number "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\nDebug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print tblName "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('" No Clearing Took Place... Err description"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" Err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Description\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\nApplication"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StatusBar "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n")])])]),a("p",[a("strong",[t._v("Finally")]),t._v(", I want to have a function to clear out all tables in the database. To do this in a fancier way, we will create a generic “ApplyAll” function as we probablly want to do other similar “apply for all” operations in the future.")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" ApplyMethodToAllTablesInDB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("funcName "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Integer")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' This function is a dispatcher of function/method called funcName on all tables in the database")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' funcName should have a parameter which is a table name")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" recSet "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ADODB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Recordset\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" tblName "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" tblNum "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Integer")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" recSet "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" conn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OpenSchema"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("adSchemaTables"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Array"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Empty"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Empty"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Empty"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"TABLE"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntblNum "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Do")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("While")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" recSet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EOF\ntblName "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" recSet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Fields"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"TABLE_NAME"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value\nCallByName "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Me")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" funcName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" VbMethod"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tblName\nrecSet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MoveNext\ntblNum "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tblNum "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Loop")]),t._v("\nApplyMethodToAllTablesInDB "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tblNum\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" recSet "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("Nothing")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" ClearAllTables"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Integer")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'This function clears all tables in DB of its contents")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''")]),t._v("\nClearAllTables "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Me")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ApplyMethodToAllTablesInDB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ClearTable"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n")])])]),a("h2",{attrs:{id:"last-but-not-the-least-we-want-to-clean-up-things"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#last-but-not-the-least-we-want-to-clean-up-things"}},[t._v("#")]),t._v(" Last but not the least, we want to clean up things")]),t._v(" "),a("p",[t._v("Especially when we are dealing with the SQL objects that could explode the computer’s memory if we don’t release them properly.")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Friend")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" Class_Terminate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' Terminates class. Important in a class like this since connection object")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' needs to be released to avoid tying up memory")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" conn "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Is")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("Nothing")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' This check important as invoking methods on a null object will cause errors.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" conn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("State "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" adStateOpen "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\nconn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Close\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" conn "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("Nothing")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n")])])]),a("p",[t._v("The class is pretty much completed. Now let’s try it out in our regular modules (main program).")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" Main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" objSQL "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" clsMSSQL\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" objSQL "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("New")]),t._v(" clsMSSQL\nobjSQL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("InitializeSQLDB "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"(local)"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Demo_Db"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sa"')]),t._v("\nMsgBox "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Database "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" objSQL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DataBaseName "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('" is connected successfully!"')]),t._v("\nobjSQL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ClearAllTables\nMsgBox "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Database tables are cleared out!"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" objSQL "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("Nothing")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n")])])]),a("p",[t._v("Yay!")])])}),[],!1,null,null,null);s.default=n.exports}}]);